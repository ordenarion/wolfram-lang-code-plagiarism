# Проект по выявлению плагиата программного кода на Wolfram Language
## Описание
Данный проект направлен на решение задачи обнаружения плагиата в студенческих работах, написанных на языке Wolfram Language.
## Предобработка данных
В рамках проекта реализован модуль `WolframPreprocessor` (`wolframPreprocessing.py`), осуществляющий:
- Очистку и нормализацию кода
- Токенизацию исходных программ

Также реализован начальный энкодер `CustomEncoder` (`myWMEncoder.py`) токенов с **Position Encoding**, что позволило улучшить работу рекуррентной модели.

## Модель на базе LSTM
Была разработана и обучена модель LSTM (`model.ipynb`), выполняющая роль малой языковой модели. Цель — построение векторного представления студенческих решений на основе последовательностей токенов Wolfram Language.

## Модель на основе UnixCoder
Для дополнительной оценки использована предобученная модель трансформера **UnixCoder** от Microsoft, обученная на широком спектре языков программирования. Несмотря на отсутствие обучения на Wolfram Language, модель позволяет улавливать универсальные паттерны кода.

## Методы оценки
Для выявления различных типов плагиата использованы следующие методы:
- **Прямой плагиат** (без изменений контекста):  
  Оценка на основе **расстояния Левенштейна** между парами решений

- **Контекстный плагиат**:
  - Последовательный анализ: сравнение эмбеддингов LSTM
  - Контекстный охват: сравнение эмбеддингов UnixCoder
 
## Основные алгоритмы (`model.ipynb`)
### Одноэтапный алгоритм
Оценивает каждую пару решений по **средневзвешенному значению**:
- Расстояние Левенштейна
- Косинусная близость эмбеддингов LSTM
- Косинусная близость эмбеддингов UnixCoder

Порог и веса были определены **эмпирически** на отложенной выборке.
< **Недостаток**: агрегированная оценка не позволяет определить тип плагиата (прямой/контекстный).

![Картинка 1 — Схема одноэтапного алгоритма](https://github.com/user-attachments/assets/04a307f2-a9e8-4a53-90e3-2ec6e22145d0)

### Двухэтапный алгоритм
1. Первый этап — проверка на прямое копирование по расстоянию Левенштейна.
2. При отсутствии прямого копирования — оценка по нейросетевым метрикам (LSTM и UnixCoder).
Позволяет **разделять типы плагиата**.

![Картинка 2 — Схема двухэтапного алгоритма](https://github.com/user-attachments/assets/c5c61854-231d-4df4-aab3-aacaf5069b1f)


## Оценка качества (Задачи А и B)

Проведена верификация на **двух размеченных выборках**: задачах A и B.  
Для каждой:
- Рассчитаны метрики **точности и полноты**
- Сравнение по отдельным моделям и полным алгоритмам (1 и 2)

| Модель / Метрика       | Задача | Levenshtein | LSTM | UnixCoder | Алгоритм 1 | Алгоритм 2 |
|------------------------|--------|-------------|------|------------|------------|------------|
| **TP**| A      | 6           | 6    | 14         | 6          | 12         |
|                        | B      | 12          | 12   | 24         | 13         | 18         |
| **FN**| A     | 14          | 14   | 4          | 12         | 6          |
|                        | B      | 18          | 18   | 5          | 17         | 12         |
| **FP**| A     | 8           | 744  | 94         | 3          | 6          |
|                        | B      | 6           | 68   | 96         | 0          | 5          |
| **Точность**           | A      | 0.43        | 0.008| 0.13       | 0.67       | 0.67       |
|                        | B      | 0.67        | 0.15 | 0.20       | 1.00       | 0.81       |
| **Полнота**            | A      | 0.31        | 0.31 | 0.81       | 0.35       | 0.70       |
|                        | B      | 0.40        | 0.41 | 0.85       | 0.44       | 0.61       |


### Суммарные метрики:

| Метрика               | Levenshtein | LSTM | UnixCoder | Алгоритм 1 | Алгоритм 2 |
|-----------------------|-------------|------|------------|------------|------------|
| **Суммарная точность**| 0.56        | 0.02 | 0.17       | 0.86       | 0.73       |
| **Суммарная полнота** | 0.36        | 0.36 | 0.81       | 0.40       | 0.62       |
